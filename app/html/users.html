<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LabFlow Manager - Gestión de Usuarios</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

    <!-- Enlace a tu archivo CSS general. La ruta es relativa desde app/html/ -->
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <nav id="sidebar">
        <header>LabFlow</header>
        <ul>
            <li><a href="home.html"><span class="material-symbols-outlined">home</span> <span class="text">Inicio</span></a></li>
            <li><a href="inventory.html"><span class="material-symbols-outlined">inventory_2</span> <span class="text">Insumos</span></a></li>
            <li><a href="productos.html"><span class="material-symbols-outlined">category</span> <span class="text">Productos</span></a></li>
            <li><a href="entradas-salidas.html"><span class="material-symbols-outlined">swap_horiz</span> <span class="text">Entradas/Salidas</span></a></li>
            <li><a href="envios.html"><span class="material-symbols-outlined">local_shipping</span> <span class="text">Envíos</span></a></li>
            <li><a href="equipos.html"><span class="material-symbols-outlined">precision_manufacturing</span> <span class="text">Equipos</span></a></li>
            <li><a href="users.html" class="admin-only"><span class="material-symbols-outlined">group</span> <span class="text">Usuarios</span></a></li>
            <li><a href="reportes.html"><span class="material-symbols-outlined">bar_chart</span> <span class="text">Reportes</span></a></li>
        </ul>
        <div id="user-info">
            <div id="user-email-display-sidebar">...</div>
            <button id="user-logout-btn-sidebar">Cerrar Sesión</button>
        </div>
    </nav>

    <main id="content">
        <header class="main-header">
            <button id="menu-toggle-btn" class="material-symbols-outlined">menu</button>
            <h1>Gestión de Usuarios</h1>
        </header>
        <div class="content-wrapper">
            <div class="table-controls">
                <h2>Todos los usuarios</h2>
                <button id="add-user-btn" class="btn btn-primary admin-only"><span class="material-symbols-outlined">person_add</span> Añadir Usuario</button>
            </div>
            <table class="users-table">
                <thead><tr><th>Nombre</th><th>Email</th><th>Rol</th><th>Último Acceso</th><th>Acciones</th></tr></thead>
                <tbody id="users-table-body"></tbody>
            </table>
        </div>
    </main>

    <!-- Modal para Añadir/Editar Usuario -->
    <div class="modal-backdrop" id="userModal">
        <div class="modal-content">
            <h2 id="userModalTitle">Añadir Usuario</h2>
            <button type="button" class="close-modal-btn material-symbols-outlined">close</button>
            <form id="userForm">
                <input type="hidden" id="user-id-field">
                <div class="form-group"><label for="username-field">Nombre de Usuario:</label><input type="text" id="username-field" required></div> 
                <div class="form-group"><label for="email-field">Email:</label><input type="email" id="email-field" required></div>
                <div class="form-group" id="password-group"><label for="password-field">Contraseña:</label><input type="password" id="password-field" placeholder="Dejar vacío para no cambiar"></div>
                <div class="form-group role-field-group"><label for="role-field">Rol:</label><select id="role-field"><option value="usuario">Usuario</option><option value="tecnico">Técnico</option><option value="administrador">Administrador</option></select></div>
                <div style="text-align: right; margin-top: 20px;"><button type="button" class="btn btn-secondary close-modal-btn">Cancelar</button><button type="submit" class="btn btn-primary" id="save-user-btn">Guardar</button></div>
            </form>
        </div>
    </div>

    <!-- Modal de Confirmación para Eliminar Usuario -->
    <div class="modal-backdrop" id="confirmModal">
        <div class="modal-content">
            <h2>Confirmar Eliminación</h2>
            <p id="confirm-message">¿Estás seguro de que quieres eliminar este usuario? Esta acción es irreversible.</p>
            <div class="modal-buttons">
                <button type="button" class="btn btn-secondary" id="cancel-delete-btn">Cancelar</button>
                <button type="button" class="btn btn-confirm-delete" id="confirm-delete-btn">Eliminar</button>
            </div>
        </div>
    </div>

    <!-- Div para mostrar notificaciones temporales de éxito/error -->
    <div id="app-notification"></div>

    <!-- Script para la lógica de la página de usuarios. La ruta es relativa desde app/html/ -->
    <script type="module" src="../js/users-script.js"></script>
</body>
</html>
